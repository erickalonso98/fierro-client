import { Component, OnInit } from '@angular/core';
import { UserService } from 'src/app/services/user.service';
import { ExploitationService } from 'src/app/services/exploitation.service';
import { Router, ActivatedRoute,Params } from '@angular/router';
import { Exploitation } from '../../models/exploitation';
import * as $ from 'jquery';
import Swal from 'sweetalert2';

@Component({
  selector: 'app-exploitation-type',
  templateUrl: './exploitation-type.component.html',
  styleUrls: ['./exploitation-type.component.css']
})
export class ExploitationTypeComponent implements OnInit {

  public title_page:string = "Crear tipo de explotacion";
  public list:string = "Información de tipos de explotación de la tierra";
  public registrarexp:string = "Registrar";
  public labelname:string = "Tipo de explotación";
  public parrafo:string = "registra el tipo de explotación de la ganadera";
  public opened:boolean = false;
  public open:string = "Abrir Menu";
  public menu:string = "Menú";
  public cerrar:string = "Cerrar";
  public person:string = "Personas";
  public property:string = "Predial";
  public iron:string = "Fierro";
  public exploitation:string = "Tipo de explotación";
  public tenencia:string = "Tipo de tenencia de la tierra";
  public type_iron:string = "Tipo de fierro";
  public users:string = "Usuarios";
  public roles:string = "Roles de usuario";
  public report:string = "Reportes";

  public identity:any;
  public token:any;
  public explotacion:Exploitation;

  constructor(
    private _userService:UserService,
    private _exploitationService:ExploitationService,
    private router:Router,
    private route:ActivatedRoute
  ) {
    this.explotacion = new Exploitation(1,'');
    this.identity = this._userService.getIdentity();
    this.token = this._userService.getToken();
   }

  ngOnInit(): void {
  }

  public toggleSidebar(){
    this.opened = !this.opened;
  }

  public onSubmit(form){
    this._exploitationService.create(this.token,this.explotacion).subscribe(
      (response) => {
        if(response.status == "success"){
            console.log(response);
            Swal.fire({
              icon: response.status,
              title: '¡Enhorabuena!',
              text: "Se ha creado con exito!!"
            })
        }else{
          Swal.fire({
            icon: 'error',
            title: '¡Oops...!',
            text: response.message
          })
        }

        form.reset();
      },
      (error) => {
        console.error(<any>error);
      }
    );
  }

}
